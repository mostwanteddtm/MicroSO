SET PATH=C:\MSVC15\BIN;
SET INCLUDE=C:\MSVC15\INCLUDE;
SET LIB=C:\MSVC15\LIB;

SET MASM_PATH=C:\MASM615\BIN\

COPY COMMON\*.*
COPY IO\*.*
COPY INCLUDE\*.*

IF EXIST STDIOA.OBJ (DEL STDIOA.OBJ)
IF EXIST STDIO.LIB (DEL STDIO.LIB)

SET /p CMP=CRIAR .EXE [Y] - .COM [N]:

IF %CMP% == Y GOTO EXE

COPY STARTUP\COM\*.*
%MASM_PATH%ML /AT /c C0T.ASM
%MASM_PATH%ML /AT /D PE=0 /c STDIO.ASM
REN STDIO.OBJ STDIOA.OBJ
CL /AT /G2 /Gs /Gx /c /Zl HELLO.C
CL /AT /G2 /Gs /Gx /c /Zl STDIO.C
LIB STDIO.LIB +STDIOA.OBJ +STDIO.OBJ,,
LINK /NOD /TINY C0T.OBJ STDIOA.OBJ STDIO.OBJ HELLO.OBJ, HELLO.COM,,,,
HELLO.COM
GOTO END

:EXE
COPY STARTUP\EXE\*.*
%MASM_PATH%ML /c C0S.ASM 
%MASM_PATH%ML /c /D PE=1 STDIO.ASM
REN STDIO.OBJ STDIOA.OBJ
CL /G2 /Gs /Gx /c /Zl HELLO.C
CL /G2 /Gs /Gx /c /Zl STDIO.C
LIB STDIO.LIB +STDIOA.OBJ +STDIO.OBJ,,
LINK /NOD C0S.OBJ STDIOA.OBJ STDIO.OBJ HELLO.OBJ, HELLO.EXE,,,,
DEL *.OBJ
HELLO.EXE

:END
DEL *.OBJ *.MAP *.ASM *.H *.INC *.LIB STDIO.C
PAUSE