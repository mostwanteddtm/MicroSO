IDTDESC	STRUCT
	BASE_LO			DW ?
	CODE_SEL		DW ?
	RESERVED		DB ?
	ATTRIBUTE		DB ?
	BASE_HI			DW ?
IDTDESC ENDS

DATASEG16 SEGMENT USE16 

	IDTR 			LABEL FWORD
	IDT_LIMIT 		DW IDT_SIZE-1
	IDT_ADDR 		DD ?
	
	
	IDT_START 		EQU $
	IDT_DESC_00h 	IDTDESC <0, SELCODEDESC16, 0, 10001110b, 0>
	IDT_DESC_01h 	IDTDESC <0, SELCODEDESC16, 0, 10001110b, 0>
	IDT_DESC_02h 	IDTDESC <0, SELCODEDESC16, 0, 10001110b, 0>
	IDT_DESC_03h 	IDTDESC <0, SELCODEDESC16, 0, 10001110b, 0>
	IDT_DESC_04h 	IDTDESC <0, SELCODEDESC16, 0, 10001110b, 0>
	IDT_DESC_05h 	IDTDESC <0, SELCODEDESC16, 0, 10001110b, 0>
	IDT_DESC_06h 	IDTDESC <0, SELCODEDESC16, 0, 10001110b, 0>
	IDT_DESC_07h 	IDTDESC <0, SELCODEDESC16, 0, 10001110b, 0>
	IDT_DESC_08h 	IDTDESC <0, SELCODEDESC16, 0, 10001110b, 0>
	IDT_SIZE 		EQU ($-IDT_START)
	
	SELINT08		EQU (OFFSET IDT_DESC_08h - IDT_START)
	
DATASEG16 ENDS

CODESEG16 SEGMENT USE16

	INSTALLIDT PROC
	
		MOV		AX, OFFSET INT08H
		MOV		IDT_DESC_08h.BASE_LO, AX
			
		XOR 	EAX, EAX
		MOV 	AX, CODESEG16
		SHL 	EAX, 4 
		ADD 	EAX, IDT_START
		MOV 	IDT_ADDR, EAX

		LIDT 	[IDTR]
		
		RET
	
	INSTALLIDT ENDP

CODESEG16 ENDS